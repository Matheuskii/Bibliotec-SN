<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BiblioTec - In√≠cio</title>
    
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/inicio.css" />
    <link rel="stylesheet" href="/css/toast.css">
    <script src="/JS/toast.js" defer></script>

    <script>
        if (localStorage.getItem('DarkMode') === 'true') {
            document.documentElement.classList.add('dark-mode');
        }
    </script>
</head>

<body>
    
    <div id="toast-box"></div>

    <header>
        <button class="hamburger" aria-label="Abrir menu">‚ò∞</button>
        <img class="logo" src="/images/LogoBibliotec.png" alt="Logo BiblioTec">
        <h1>BIBLIO TEC</h1>
        <button class="dark-mode-toggle" id="dark-mode-btn" title="Modo escuro">üåô</button>
    </header>

    <nav>
        <a href="/Catalogo.html">Cat√°logo</a>
        <a href="/Favoritos.html">Favoritos</a>
        <a href="/Reservas.html">Minhas Reservas</a>
        <a href="/Admin.html" id="btnAdminPanel" style="display: none; color: #ff0000; font-weight: bold;">Painel Admin</a>
        <a href="/Login.html" id="btnAuth" style="text-decoration: none; color: #4a67df; font-weight: bold;">Login</a>
    </nav>

    <div class="search-container">
        <input type="text" class="search-bar" placeholder="Pesquisar..." />
        <span class="search-icon"> <img src="/images/Lupa.png" alt="√çcone de lupa para pesquisa"></span>
    </div>

    <section>
        <div class="section-header">
            <h2>Mais Procurados</h2>
        </div>
        <div class="books-container">
            <div class="carousel-wrapper">
                <button class="arrow-left" id="left-vendidos">‚óÄ</button>
                <div class="books-grid" id="vendidos"></div>
                <button class="arrow-right" id="right-vendidos">‚ñ∂</button>
            </div>
        </div>
    </section>

    <section>
        <div class="section-header">
            <h2>Ofertas e Destaques</h2> </div>
        <div class="books-container">
            <div class="carousel-wrapper">
                <button class="arrow-left" id="left-ofertas">‚óÄ</button>
                <div class="books-grid" id="ofertas"></div>
                <button class="arrow-right" id="right-ofertas">‚ñ∂</button>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <p>¬© 2025 BiblioTec - Todos os direitos reservados.</p>
            <div class="footer-links">
                <a href="#">Sobre</a>
                <a href="#">Termos de Uso</a>
                <a href="#">Privacidade</a>
                <a href="#">Contato</a>
            </div>
        </div>
    </footer>

    <script type="module">
        import { criarCarrossel, verificarEstadoLogin } from "./JS/Estrutura.js";
        
        // Verifica se √© Admin ou Aluno para ajustar o menu
        verificarEstadoLogin();

        // --- CARROSSEL 1: MAIS VENDIDOS ---
        criarCarrossel("vendidos", "#left-vendidos", "#right-vendidos", (livro) => {
            const genero = livro.genero ? livro.genero.toLowerCase() : "";
            const id = Number(livro.id);

            // Regra: G√™neros populares OU IDs antigos (cl√°ssicos)
            return genero.includes('fantasia') ||
                genero.includes('romance') ||
                genero.includes('infantil') ||
                id <= 5;
        });

        // --- CARROSSEL 2: OFERTAS ---
        criarCarrossel("ofertas", "#left-ofertas", "#right-ofertas", (livro) => {
            const genero = livro.genero ? livro.genero.toLowerCase() : "";
            const formato = livro.formato ? livro.formato.toLowerCase() : "";

            // Regra: G√™neros de nicho OU E-books
            return genero.includes('terror') ||
                genero.includes('suspense') ||
                genero.includes('policial') ||
                formato === 'e-book';
        });
    </script>

    <script>
        (function () {
            const darkModeBtn = document.getElementById('dark-mode-btn');
            const htmlElement = document.documentElement;

            // Padr√£o: Verifica se j√° est√° ativo
            const isDarkMode = localStorage.getItem('DarkMode') === 'true';

            if (isDarkMode) {
                if (darkModeBtn) darkModeBtn.textContent = '‚òÄÔ∏è';
            }

            if (darkModeBtn) {
                darkModeBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    const isCurrentlyDark = htmlElement.classList.contains('dark-mode');

                    if (isCurrentlyDark) {
                        htmlElement.classList.remove('dark-mode');
                        darkModeBtn.textContent = 'üåô';
                        localStorage.setItem('DarkMode', 'false');
                    } else {
                        htmlElement.classList.add('dark-mode');
                        darkModeBtn.textContent = '‚òÄÔ∏è';
                        localStorage.setItem('DarkMode', 'true');
                    }
                });
            }
        })();
    </script>
</body>
</html>